## Elastic Kubernetes Service (EKS)
Is a managed container orchestration service that facilitates deploying, managing, and scaling Kubernetes applications in the AWS Cloud or on premises.

Helps to provide highly available and secure clusters. 

Also helps you automate key tasks such as patching, node provisioning, and updates.

### The need for container orchestration
Containers provide a standard way to package your application's code, configurations, and dependencies into a single object.

They are lightweight and provide a consistent, portable software environment for applications to run and scale anywhere.
Applications running in containers require a container orchestration platform to manage and scale deployments.

Different management platforms might manage different aspects of the container system.

# Benefits
### Managed Kubernetes service
![[Pasted image 20251126172417.png]]
### Tightly integrated with AWS services
![[Pasted image 20251126172440.png]]
### Built with the Community
![[Pasted image 20251126172458.png]]
### Conformant and Compatible
![[Pasted image 20251126172521.png]]

![[Pasted image 20251126173238.png]]
![[Pasted image 20251126173255.png]]

# Kubernetes
## Cluster
A set of worker machines, called nodes, that run containerized applications.
- Every cluster has at least one worker node. 
- A cluster also has a control plane that runs services that manage the cluster.
![[Pasted image 20251126174212.png]]

## Node
A virtual or physical machine, which runs the workload by grouping containers into pods and assigning those pods to run on nodes.
Each node is managed by the control plane and contains the services necessary to run pods.

## Pod
A group of one or more containers.
- Are defined by a PodSpec file, a specification for how to run the containers.
- Pods are the basic building block within Kubernetes for deployment, scaling, and replication.

![[Pasted image 20251126174315.png]]

## Ephemeral volume
Applications in a pod have access to shared volumes to facilitate data sharing in the pod and persistence of data across container restarts.
- When a pod ceases to exist, Kubernetes destroys ephemeral volumes.
## Persistent volume
Similar to an ephemeral volume but has a lifecycle independent of any individual pod that uses them.
Persistent volumes are backed by storage subsystems independent of cluster nodes.

## Service
A logical collection of pods and a means to access them.
The service is continually updated with the set of pods available, eliminating the need for pods to track other pods.
![[Pasted image 20251126175154.png|700]]
## Namespace
A virtual cluster that is backed by the same physical cluster.
- Physical clusters can have resources with the same name as long as they are in different namespaces.
- Namespaces are especially useful when you have multiple teams or projects using the same cluster.
![[Pasted image 20251126175146.png|700]]

## ReplicaSet
Ensures that a specific number of pod replicas are running at any given time.
![[Pasted image 20251126175130.png|700]]

## Deployment
Owns and manages ReplicaSets or individual pods.
- Describes a desired state in the deployment.
- The deployment then changes the actual state of the cluster to the desired state at a controlled rate.
![[Pasted image 20251126183351.png|700]]
## ConfigMap
Is an API object that stores nonconfidential data as key-value pairs used by other Kubernetes objects, such as pods.
- Use ConfigMaps to follow the best practice of portability by separating your configuration data from your application code.
![[Pasted image 20251126183413.png|700]]
## Secrets
All confidential data, such as AWS credentials.
Secrets restrict access to sensitive information. 
- Optionally, encryption can be turned on to improve security.

# Pod scheduling
Checks the resources required by the pods and uses that information to influence the scheduling decision.
The scheduler runs a series of filters to exclude ineligible nodes for pod placement.
![[Pasted image 20251126183538.png|700]]
# Control & Data plane
### Control Plane nodes
Manage the worker nodes and the pods in the cluster.
Determines when tasks are schedules and where they are routed to. It includes:
- Controller manager
- Cloud controller
- Scheduler
- API Server
- etcd
#### Controller manager
Runs background threads called controllers that detect and responder to cluster events
#### Cloud controller
Is a specific controller that interacts with the underlying cloud provider
#### Scheduler
Selects nodes for newly created containers to run on
#### API Server
Exposes the Kubernetes API and is the frontend for the Kubernetes control plane.
- Handles all communication from the cluster to the control plane.
- None of the other control plane components are designes to expose remote services
- The Kubernetes API is designes to scale horizontally, deploying more instances as necessary
#### etcd
The core persistence layer for Kubernetes.
- A highly available distributed key value store
- This is where the critical cluster data and state are stored
### Data plane
Worker nodes host the pods that are the components of the application workload.
Is where the tasks are run. This is all done on the worker nodes. It includes:
- Worker nodes
- kube-proxy
- Contarimer runtime
- kubelet
- Pods
#### kube-proxy
Helps with networking. Maintains network rules on the host and performs any connection forwarding that may be necessary

#### Container runtime
Kubernetes supports several runtimes, with Docker being the most common
#### kubelet
The primaty agent that runs on the worker nodes. 
- Makes sure that the right containers are running in a pod and that tey are healthy
#### Pods
A group of one or more containers
- The containers in a pod are always colocated, scheduled and managed together, cannot split containers in a pod across nodes
- Applications in a pod can easily communicate with each other
- Considered to be relatively ephemeral entities
	- Can disappear if the become unhealthy, and new ones can take their place
## Custom resources
In addition to the resources that Kubernetes defines (such as pods and deployments), can also extend the Kubernetes API and create custom resources.
- Custom resources are created with a Custom Resource Definition (CRD).
- Custom resources can be controlled with custom controllers. Custom controllers run in pods on the worker nodes of your cluster.
- When used to automate the management of custom resources in a cluster, custom controllers are referred to as operators
- It is good practice to use operators instead of manually updating your native Kubernetes objects.
## kubectl
Is a command line interface (CLI) for communicating with the Kubernetes API server.
- It provides commands to create resources, view detailed information about the cluster and resources, and access troubleshooting tools.
- kubectl commands are used to roll out, scale, and automatically scale resources.
- Syntax: **`kubectl [command] [TYPE] [NAME] [flags]`** 
	- *Command*: Specifies the operation you are performing.
	- _Type_: Specifies the resource type.
	- _Name_: Specifies the name of the resource.
	- _Flag_: Specifies optional flags.
# Amazon EKS control plane
Amazon EKS provides a scalable, highly available control plane. 

It automatically manages the availability and scalability of the Kubernetes API servers and the etcd persistence layer for each cluster.
### Amazon EKS availability and API
Amazon EKS control plane consists of at least two API server nodes and three etcd nodes across three Availability Zones.

It automatically detects and replaces unhealthy control plane nodes, which removes a significant operational burden for running Kubernetes. With this capability, you can focus on building your applications instead of managing AWS infrastructure.

To get started with Amazon EKS, you provision your cluster of worker nodes. Amazon EKS handles the provisioning, scaling, and management of the Kubernetes control plane in a highly available and secure configuration.
Then connect to the Amazon EKS cluster using the graphical or command line interface.
After that, it's ready to deploy the Kubernetes applications to the Amazon EKS cluster.

Amazon EKS manages the Kubernetes control plane with the Amazon EKS API.
Can use one of two CLIs to interact with the Amazon EKS API: **Amazon EKS CLI or eksctl**
The eksctl utility uses AWS CloudFormation in the background to build clusters based on the options you specify.

## Amazon EKS API
![[Pasted image 20251126191301.png]]
## Kubernetes API
![[Pasted image 20251126191325.png]]
# Amazon EKS data plane
## Self-managed Nodes
Only the control plane is managed by Amazon EKS. You completely control and manage your data plane nodes (including provisioning, updating, monitoring, and other tasks).

## Managed Node groups
Managed node groups use the Amazon EKS API to start and manage the Amazon Elastic Compute Cloud (Amazon EC2) instances that run containers for an Amazon EKS cluster.
![[Pasted image 20251126192024.png]]

![[Pasted image 20251126192048.png]]

